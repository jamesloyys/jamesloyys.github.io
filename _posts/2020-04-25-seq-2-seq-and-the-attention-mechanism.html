---
layout: post
title: Seq2Seq and the Attention Mechanism
date: 2020-04-25 00:00:00 +0000
description: # Add post description (optional)
img: seq2seq.jpg # Add image post (optional)
fig-caption: # Add figcaption (optional)
tags: [Deep Learning, NLP]
---


<html>
	 <head>
			<script type = "text/javascript" src = "https://d3js.org/d3.v4.min.js"></script>
			<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
			<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
			<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

			<!-- <link rel="stylesheet" href="styles.css"> -->
	 </head>

	 <body>

	 	Seq2Seq models and the attention mechanism have become important cornerstones in the world of deep learning and NLP. In this article, we'll visualize what the seq2seq model is, and how the attention mechanism works.

	 	<h2>Seq2Seq Models in NLP</h2>

	 	Neural networks and deep learning have proven to be powerful algorithms for solving a wide range of problems in AI, particularly in Computer Vision based problems such as image recognition. However, one drawback of conventional neural networks is that they require a fix length input. This is no problem for vision based problems, as its inputs are images of fixed dimensions. However, this is a stumbling block in the world of NLP, as problems such as machine translation and speech recognition have variable length inputs that are known a-priori. For example, in machine translation, an AI model has to be able to translate sentences of any length - this does not fit well with the fix length input requirement of conventional neural networks. <br>

	 	To that end, Seq2Seq models were introduced by Sutskever et al to tackle this problem. Seq2Seq models are neural networks that takes in a variable length sequence as input, and outputs another variable length sequence. <br>

	 	At its core, Seq2Seq models consist of an <b>Encoder</b> and a <b>Decoder</b> component. The role of the Encoder is to learn a compressed representation of the input sequences. This compressed representation is also known as the <b>context vector</b>. The decoder then picks up this context vector, and outputs a sequence. <br>

	 	To solidify our understand, let's take a closer look at how Seq2Seq models uses the encoder and decoder to translate a sentence from english to chinese. <br>

	 	Looking at the diagram below, the input to the model is the english sentence 'How are you'. The encoder processes the sentence word by word, until it reaches the end of the sentence. The &lt;EOS&gt; tag is a special tag that informs the encoder that the end of the sentence has been reached. Once the encoder sees the &lt;EOS&gt; tag, the encoder outputs the context vector. <br>

	 	The context vector contains the compressed representation of the input sentence. The decoder now reads the context vector, and begins to produce the output sequence word by word. Again, the &lt;EOS&gt; tag is used to denote the end of the output sequence. The decoder ends when it outputs the &lt;EOS&gt; tag. <br>

	 	<img src= 'assets/img/seq2seq.png'>

	 	<div>
			<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
				 viewBox="0 0 612 590">
			<style type="text/css">
				.st0{fill:#FFFFFF;stroke:#000000;stroke-miterlimit:10;}
				.st1{fill:#FFF0D6;stroke:#000000;stroke-miterlimit:10;}
				.st2{fill:none;stroke:#000000;stroke-miterlimit:10;}
				.st3{fill:#99D4C0;stroke:#000000;stroke-miterlimit:10;}
				.st4{fill:#F1F8FD;stroke:#000000;stroke-miterlimit:10;}
				.st5{fill:#FFFFFF;}
				.st6{fill:#010101;}
				.st7{font-family:'Helvetica';}
				.st8{font-size:12px;}
				.st9{stroke:#000000;stroke-miterlimit:10;}
			</style>
			<path class="st1" d="M130,300.3c-4,0-42.8,0-46.5,0c-1.5,0-9.7-0.2-16.3-6.8c-4.2-4.2-6.8-9.9-6.8-16.3v-22.1
				c0-12.7,10.3-23.1,23.1-23.1H130c12.7,0,23.1,10.3,23.1,23.1v22.1C153.1,290,142.8,300.3,130,300.3z"/>
			<path class="st1" d="M263,300.3h-23.3h-23.3c-12.7,0-23.1-10.3-23.1-23.1v-22.1c0-12.7,10.3-23.1,23.1-23.1H263
				c12.7,0,23.1,10.3,23.1,23.1v22.1C286.1,290,275.8,300.3,263,300.3z"/>
			<g>
				<line x1="153.1" y1="266.1" x2="193.4" y2="266.1"/>
				<g>
					<line class="st2" x1="153.1" y1="266.1" x2="187.4" y2="266.1"/>
					<g>
						<path d="M193.4,266.1c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C187.1,263.3,190.6,265.1,193.4,266.1z"/>
					</g>
				</g>
			</g>
			<path class="st1" d="M396,300.3h-46.5c-12.7,0-23.1-10.3-23.1-23.1v-22.1c0-12.7,10.3-23.1,23.1-23.1H396
				c12.7,0,23.1,10.3,23.1,23.1v22.1C419.1,290,408.8,300.3,396,300.3z"/>
			<g>
				<line x1="286.1" y1="266.1" x2="326.4" y2="266.1"/>
				<g>
					<line class="st2" x1="286.1" y1="266.1" x2="320.4" y2="266.1"/>
					<g>
						<path d="M326.4,266.1c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C320.1,263.3,323.6,265.1,326.4,266.1z"/>
					</g>
				</g>
			</g>
			<path class="st1" d="M529,300.3h-23.3h-23.3c-12.7,0-23.1-10.3-23.1-23.1v-22.1c0-12.7,10.3-23.1,23.1-23.1H529
				c12.7,0,23.1,10.3,23.1,23.1v22.1C552.1,290,541.8,300.3,529,300.3z"/>
			<g>
				<line x1="419.1" y1="266.1" x2="459.4" y2="266.1"/>
				<g>
					<line class="st2" x1="419.1" y1="266.1" x2="453.4" y2="266.1"/>
					<g>
						<path d="M459.4,266.1c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C453.1,263.3,456.6,265.1,459.4,266.1z"/>
					</g>
				</g>
			</g>
			<path id="outputBox1" class="st3" d="M130,491H83.5c-12.7,0-23.1-10.3-23.1-23.1v-22.1c0-12.7,10.3-23.1,23.1-23.1H130
				c12.7,0,23.1,10.3,23.1,23.1v22.1C153.1,480.7,142.8,491,130,491z"/>
			<path id="outputBox2" class="st3" d="M263,491h-46.5c-12.7,0-23.1-10.3-23.1-23.1v-22.1c0-12.7,10.3-23.1,23.1-23.1H263
				c12.7,0,23.1,10.3,23.1,23.1v22.1C286.1,480.7,275.8,491,263,491z"/>
			<g>
				<line x1="153.1" y1="456.9" x2="193.4" y2="456.9"/>
				<g>
					<line class="st2" x1="153.1" y1="456.9" x2="187.4" y2="456.9"/>
					<g>
						<path d="M193.4,456.9c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C187.1,454,190.6,455.8,193.4,456.9z"/>
					</g>
				</g>
			</g>
			<path id="outputBox3" class="st3" d="M396,491h-46.5c-12.7,0-23.1-10.3-23.1-23.1v-22.1c0-12.7,10.3-23.1,23.1-23.1H396
				c12.7,0,23.1,10.3,23.1,23.1v22.1C419.1,480.7,408.8,491,396,491z"/>
			<g>
				<line x1="286.1" y1="456.9" x2="326.4" y2="456.9"/>
				<g>
					<line class="st2" x1="286.1" y1="456.9" x2="320.4" y2="456.9"/>
					<g>
						<path d="M326.4,456.9c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C320.1,454,323.6,455.8,326.4,456.9z"/>
					</g>
				</g>
			</g>
			<path id="outputBox4" class="st3" d="M529,491h-46.5c-12.7,0-23.1-10.3-23.1-23.1v-22.1c0-12.7,10.3-23.1,23.1-23.1H529
				c12.7,0,23.1,10.3,23.1,23.1v22.1C552.1,480.7,541.8,491,529,491z"/>
			<g>
				<line x1="419.1" y1="456.9" x2="459.4" y2="456.9"/>
				<g>
					<line class="st2" x1="419.1" y1="456.9" x2="453.4" y2="456.9"/>
					<g>
						<path d="M459.4,456.9c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C453.1,454,456.6,455.8,459.4,456.9z"/>
					</g>
				</g>
			</g>
			<path id="p12" class="st2" d="M109.9,300.3C240,366,239.8,422.7,239.8,422.7"/>
			<path id="p32" class="st2" d="M372.8,300.3c-130.8,55.7-133,122.4-133,122.4"/>
			<line id="p22" class="st2" x1="239.8" y1="300.3" x2="239.8" y2="422.7"/>
			<path id="p42" class="st2" d="M505.8,300.3c-266.8,64.7-266,122.4-266,122.4"/>
			<path id="p13" class="st2" d="M106.8,300.3c265.2,61.7,266,122.4,266,122.4"/>
			<path id="p23" class="st2" d="M239.8,300.3c132.2,74.7,133,122.4,133,122.4"/>
			<path id="p43" class="st2" d="M505.8,300.3c-133.8,66.7-133,122.4-133,122.4"/>
			<line id="p33" class="st2" x1="372.8" y1="300.3" x2="372.8" y2="422.7"/>
			<line id="p44" class="st2" x1="505.8" y1="300.3" x2="505.8" y2="422.7"/>
			<path id="p14" class="st2" d="M100.7,300.3C505,372,505.8,422.7,505.8,422.7"/>
			<path id="p24" class="st2" d="M239.8,300.3c267.2,75.7,266,122.4,266,122.4"/>
			<path id="p34" class="st2" d="M372.8,300.3c133.2,70.7,133,122.4,133,122.4"/>
			<path class="st4" d="M136.5,122.1H90c-12.7,0-23.1-10.3-23.1-23.1V76.8c0-12.7,10.3-23.1,23.1-23.1h46.5c12.7,0,23.1,10.3,23.1,23.1
				V99C159.6,111.7,149.3,122.1,136.5,122.1z"/>
			<path class="st4" d="M263,122.1h-46.5c-12.7,0-23.1-10.3-23.1-23.1V76.8c0-12.7,10.3-23.1,23.1-23.1H263c12.7,0,23.1,10.3,23.1,23.1
				V99C286.1,111.7,275.8,122.1,263,122.1z"/>
			<path class="st4" d="M396,122.1h-46.5c-12.7,0-23.1-10.3-23.1-23.1V76.8c0-12.7,10.3-23.1,23.1-23.1H396c12.7,0,23.1,10.3,23.1,23.1
				V99C419.1,111.7,408.8,122.1,396,122.1z"/>
			<path class="st4" d="M529,122.1h-46.5c-12.7,0-23.1-10.3-23.1-23.1V76.8c0-12.7,10.3-23.1,23.1-23.1H529c12.7,0,23.1,10.3,23.1,23.1
				V99C552.1,111.7,541.8,122.1,529,122.1z"/>
			<g>
				<line class="st5" x1="159.6" y1="87.9" x2="193.4" y2="87.9"/>
				<g>
					<line class="st2" x1="159.6" y1="87.9" x2="187.4" y2="87.9"/>
					<g>
						<path d="M193.4,87.9c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C187.1,85.1,190.6,86.9,193.4,87.9z"/>
					</g>
				</g>
			</g>
			<g>
				<line class="st5" x1="286.1" y1="87.9" x2="326.4" y2="87.9"/>
				<g>
					<line class="st2" x1="286.1" y1="87.9" x2="320.4" y2="87.9"/>
					<g>
						<path d="M326.4,87.9c-2.8,1.1-6.4,2.9-8.5,4.8l1.7-4.8l-1.7-4.8C320.1,85.1,323.6,86.9,326.4,87.9z"/>
					</g>
				</g>
			</g>
			<g>
				<line class="st5" x1="419.1" y1="87.9" x2="459.4" y2="87.9"/>
				<g>
					<line class="st2" x1="419.1" y1="87.9" x2="451.3" y2="87.9"/>
					<g>
						<path d="M449.5,87.9l-2.2-3.6l0.1-0.1l5.9,2.3c2,0.5,4.1,0.9,6.1,1.4c-2,0.5-4.1,0.9-6.1,1.4l-5.9,2.3l-0.1-0.1L449.5,87.9z"/>
					</g>
				</g>
			</g>
			<g>
				<line x1="109.9" y1="122.1" x2="109.9" y2="232"/>
				<g>
					<line class="st2" x1="109.9" y1="122.1" x2="109.9" y2="226"/>
					<g>
						<path d="M109.9,232c-1.1-2.8-2.9-6.4-4.8-8.5l4.8,1.7l4.8-1.7C112.7,225.6,110.9,229.2,109.9,232z"/>
					</g>
				</g>
			</g>
			<g>
				<line x1="239.8" y1="122.1" x2="239.8" y2="232"/>
				<g>
					<line class="st2" x1="239.8" y1="122.1" x2="239.8" y2="226"/>
					<g>
						<path d="M239.8,232c-1.1-2.8-2.9-6.4-4.8-8.5l4.8,1.7l4.8-1.7C242.6,225.6,240.8,229.2,239.8,232z"/>
					</g>
				</g>
			</g>
			<g>
				<line x1="372.8" y1="122.1" x2="372.8" y2="232"/>
				<g>
					<line class="st2" x1="372.8" y1="122.1" x2="372.8" y2="226"/>
					<g>
						<path d="M372.8,232c-1.1-2.8-2.9-6.4-4.8-8.5l4.8,1.7l4.8-1.7C375.6,225.6,373.8,229.2,372.8,232z"/>
					</g>
				</g>
			</g>
			<g>
				<line x1="505.8" y1="122.1" x2="505.8" y2="232"/>
				<g>
					<line class="st2" x1="505.8" y1="122.1" x2="505.8" y2="226"/>
					<g>
						<path d="M505.8,232c-1.1-2.8-2.9-6.4-4.8-8.5l4.8,1.7l4.8-1.7C508.6,225.6,506.8,229.2,505.8,232z"/>
					</g>
				</g>
			</g>
			<g id="page1" transform="matrix(1.13 0 0 1.13 -63.986 -63.3222)">
				<g>
					<path id="g0-104" class="st6" d="M148,120.6c0-0.1,0.1-0.3,0.1-0.5c0-0.3-0.3-0.3-0.4-0.3c0,0-1.7,0.1-1.9,0.2
						c-0.6,0-1.1,0.1-1.7,0.1c-0.9,0.1-1.1,0.1-1.1,0.7c0,0.3,0.3,0.3,0.7,0.3c1.7,0,1.7,0.3,1.7,0.6c0,0.2-0.1,0.5-0.1,0.6l-4.9,19.3
						c-0.1,0.5-0.1,0.6-0.1,0.8c0,0.7,0.6,0.9,0.9,0.9c0.6,0,1-0.4,1.2-0.8l1.5-6c0.2-0.7,0.4-1.4,0.5-2.2c0.4-1.4,0.4-1.4,1-2.4
						c0.6-1,2.2-3,4.8-3c1.4,0,1.8,1,1.8,2.3c0,1.9-1.3,5.5-2.1,7.5c-0.3,0.8-0.5,1.2-0.5,1.8c0,1.5,1.1,2.7,2.7,2.7
						c3.2,0,4.4-4.9,4.4-5.1c0-0.2-0.1-0.3-0.3-0.3c-0.3,0-0.3,0.1-0.5,0.7c-0.8,2.7-2,4.1-3.4,4.1c-0.3,0-0.9,0-0.9-1.1
						c0-0.9,0.4-1.9,0.5-2.3c0.6-1.6,2.1-5.5,2.1-7.5c0-2-1.2-3.5-3.8-3.5c-1.9,0-3.6,0.9-5,2.6L148,120.6z"/>
				</g>
				<g>
					<path id="g1-49" class="st6" d="M164.5,133.1c0-0.6,0-0.6-0.5-0.6c-1.5,1.5-3.5,1.5-4.3,1.5v0.7c0.5,0,1.9,0,3.1-0.6v12
						c0,0.8-0.1,1.1-2.2,1.1h-0.8v0.7c0.8-0.1,2.9-0.1,3.8-0.1s3,0,3.8,0.1v-0.7h-0.8c-2.1,0-2.2-0.3-2.2-1.1V133.1z"/>
				</g>
			</g>
			<text transform="matrix(1 0 0 1 10 95.0928)" class="st7 st8">Encoder</text>
			<text transform="matrix(1 0 0 1 10 462.0928)" class="st7 st8">Decoder</text>
			<text transform="matrix(1 0 0 1 7 266.1383)"><tspan x="0" y="0" class="st7 st8">Context</tspan><tspan x="0" y="14.4" class="st7 st8">Vectors</tspan></text>
			<line id="p11" class="st9" x1="103.8" y1="300.3" x2="103.8" y2="422.7"/>
			<path id="p21" class="st2" d="M239.8,300.3c-127.8,67.7-133,122.4-133,122.4"/>
			<path id="p31" class="st2" d="M372.8,300.3c-264.8,65.7-266,122.4-266,122.4"/>
			<path id="p41" class="st2" d="M505.8,300.3c-396.8,74.7-399,122.4-399,122.4"/>
			</svg>

		Fam locavore snackwave bushwick +1 sartorial. Selfies portland knausgaard synth. Pop-up art party marfa deep v pitchfork subway tile 3 wolf moon. Ennui pinterest tumblr yr, adaptogen succulents copper mug twee. Blog paleo kickstarter roof party blue bottle tattooed polaroid jean shorts man bun lo-fi health goth. Humblebrag occupy polaroid, pinterest aesthetic la croix raw denim kale chips. 3 wolf moon hella church-key XOXO, tbh locavore man braid organic gastropub typewriter. Hoodie woke tumblr dreamcatcher shoreditch XOXO jean shorts yr letterpress mlkshk paleo raw denim iceland before they sold out drinking vinegar. Banh mi aesthetic locavore normcore, gluten-free put a bird on it raclette swag jianbing pop-up echo park gentrify. Stumptown brooklyn godard tumeric ethical. Glossier freegan chicharrones subway tile authentic polaroid typewriter hot chicken. Thundercats small batch heirloom meggings.


		</div>

	
	<script>


		// d3.select("#boundingBox")
		// 	 .on('mouseout', function (d, i) {
		// 				d3.selectAll("#p11,#p21,#p31,#p41,#p12,#p22,#p32,#p42,#p13,#p23,#p33,#p43,#p14,#p24,#p34,#p44").attr('opacity', 100)
		// 			})

		d3.select("#outputBox1")
			 .on('mouseover', function (d, i) {
						d3.selectAll("#p11, #p21, #p31, #p41").attr('opacity', 100)
						d3.selectAll("#p12,#p22,#p32,#p42,#p13,#p23,#p33,#p43,#p14,#p24,#p34,#p44").attr('opacity', 0)
					})


		d3.select("#outputBox2")
			 .on('mouseover', function (d, i) {
						d3.selectAll("#p12, #p22, #p32, #p42").attr('opacity', 100)
						d3.selectAll("#p11,#p21,#p31,#p41,#p13,#p23,#p33,#p43,#p14,#p24,#p34,#p44").attr('opacity', 0)
					})

		d3.select("#outputBox3")
			 .on('mouseover', function (d, i) {
						d3.selectAll("#p13,#p23,#p33,#p43").attr('opacity', 100)
						d3.selectAll("#p11,#p21,#p31,#p41,#p12, #p22, #p32, #p42,#p14,#p24,#p34,#p44").attr('opacity', 0)
					})

		d3.select("#outputBox4")
			 .on('mouseover', function (d, i) {
						d3.selectAll("#p14,#p24,#p34,#p44").attr('opacity', 100)
						d3.selectAll("#p11,#p21,#p31,#p41,#p12,#p22,#p32,#p42,#p13,#p23,#p33,#p43").attr('opacity', 0)
					})


	</script>

	</body>

</html>


